import{r as n,u as F,o as q,j as e,m as i,L as P,s as H,a as L,p as J,q as V,f as D,g as b,w as R,h as z,i as G,k as Q,l as k,n as W,t as Y}from"./index-DgKth4ln.js";const S="keyword_tool_data";function B(){const[l,u]=n.useState(""),[x,g]=n.useState([]),[p,h]=n.useState([]),[d,j]=n.useState(!1),[v,w]=n.useState(""),[s,N]=n.useState(null),[C,_]=n.useState(!0),I=F();n.useEffect(()=>{const t=q(L,a=>{N(a),_(!1)});return()=>t()},[]);const O=async()=>{try{const t=await H(L,J);N(t.user),I("/keyword-tool/dashboard")}catch(t){console.error("Error signing in:",t)}};n.useEffect(()=>{try{const t=localStorage.getItem(S);if(t){const a=JSON.parse(t);a.keyword&&u(a.keyword),a.results&&g(a.results),a.relatedKeywords&&h(a.relatedKeywords)}}catch(t){console.error("Error loading data from localStorage:",t)}},[]);const T=()=>{u(""),g([]),h([]),w("");try{localStorage.removeItem(S)}catch(t){console.error("Error clearing localStorage:",t)}},A=(t,a)=>{const c=Math.floor(Math.random()*41)+60,y=a.length*100+Math.floor(Math.random()*401)+100;let o=0;return a.length>0?(o=a.reduce((m,r)=>{const f=typeof r=="string"?r:r.keyword||"";return m+f.length},0),o=Math.round(o/a.length)):o=t.length,{seoScore:c,searchVolume:y,averageLength:o}},E=async()=>{if(l.trim()){j(!0),w(""),g([]),h([]);try{const a=await(await fetch(`https://google-search74.p.rapidapi.com/?query=${encodeURIComponent(l)}&limit=10&related_keywords=true`,{headers:{"x-rapidapi-host":"google-search74.p.rapidapi.com","x-rapidapi-key":"4a04ac759dmsh0ac4120760e65d0p1da314jsn3071e48385e9"}})).json();console.log("API Data:",a);const c=a?.related_keywords?.keywords||[],y=a?.results||[];h(c),g(y);const o=A(l.trim(),c),m=c.map(r=>typeof r=="string"?r:r.keyword||"");if(s)try{const r=l.trim(),f=V(D(b,"keyword_searches"),R("uid","==",s.uid),R("keyword","==",r)),K=await z(f);if(K.empty)await Y(D(b,"keyword_searches"),{uid:s.uid,keyword:r,searchDate:k(),lastSearch:k(),searchCount:1,averageSEOScore:o.seoScore,length:o.averageLength,relatedKeywords:m}),console.log("Created new keyword search document");else{const M=K.docs[0],U=G(b,"keyword_searches",M.id);await Q(U,{searchCount:W(1),lastSearch:k(),averageSEOScore:o.seoScore,length:o.averageLength,relatedKeywords:m}),console.log("Updated existing keyword search document")}}catch(r){console.error("Error saving to Firestore:",r)}try{const r={keyword:l.trim(),results:y,relatedKeywords:c,timestamp:new Date().toISOString()};localStorage.setItem(S,JSON.stringify(r))}catch(r){console.error("Error saving to localStorage:",r)}}catch{w("Failed to fetch keywords. Please try again.")}finally{j(!1)}}};return C?e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 flex items-center justify-center",children:e.jsx(i.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full"})}):e.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-900 px-3 py-10 text-gray-800 dark:text-gray-100",children:[e.jsxs(i.div,{className:"text-center mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[e.jsx("h1",{className:"mb-6",children:"🔍 Keyword & SEO Analyzer"}),e.jsx("div",{className:"flex items-center flex-wrap justify-center gap-4",children:s?e.jsxs(e.Fragment,{children:[e.jsx(P,{to:"/keyword-tool/dashboard",className:"inline-flex items-center whitespace-nowrap gap-2 bg-main/80 hover:bg-main duration-300 text-white rounded-md px-2.5 py-1.5 font-medium",children:e.jsx("span",{children:"📊 View Dashboard"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:s.photoURL||"",alt:s.displayName||"User",className:"w-8 h-8 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600 whitespace-nowrap dark:text-gray-400",children:s.displayName||"User"})]})]}):""})]}),e.jsxs(i.div,{className:"max-w-xl mx-auto flex flex-col md:flex-row items-center gap-3",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[e.jsx("input",{type:"text",placeholder:"Enter your keyword...",className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-gray-100 dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 outline-none transition",value:l,onChange:t=>u(t.target.value),onKeyDown:t=>t.key==="Enter"&&E()}),e.jsx(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:s?E:O,disabled:d||!s,className:"bg-main/80 hover:bg-main duration-300 disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold px-5 py-2 rounded-lg transition shadow-md",children:s?d?"Searching...":"Search":"Login to Search"}),(x.length>0||p.length>0)&&e.jsx(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:T,className:"bg-red-600 hover:bg-red-700 text-white font-semibold px-5 py-2 rounded-lg transition",children:"Clear"})]}),d&&e.jsx("p",{className:"text-center mt-6 text-blue-500 animate-pulse",children:"Fetching results..."}),v&&e.jsx("p",{className:"text-center mt-6 text-red-500",children:v}),!d&&p.length>0&&e.jsxs(i.div,{className:"max-w-2xl mx-auto mt-10 bg-gray-50 dark:bg-gray-800 rounded-xl shadow-lg p-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsx("h2",{className:"text-xl font-bold mb-3 text-blue-600 dark:text-blue-400",children:"Related Keywords"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:p.map((t,a)=>e.jsx(i.li,{className:"text-gray-800 dark:text-gray-200",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:a*.05},children:t.keyword},a))})]}),!d&&x.length>0&&e.jsxs(i.div,{className:"max-w-3xl mx-auto mt-10 bg-gray-50 dark:bg-gray-800 rounded-xl shadow-lg p-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsx("h2",{className:"text-xl font-bold mb-3 text-green-600 dark:text-green-400",children:"Top Search Results"}),e.jsx("div",{className:"space-y-4",children:x.map((t,a)=>e.jsxs(i.div,{className:"border-b border-gray-200 dark:border-gray-700 pb-3",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:a*.07},children:[e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-lg font-semibold text-blue-600 dark:text-blue-400 hover:underline",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t.description})]},a))})]})]})}export{B as default};
